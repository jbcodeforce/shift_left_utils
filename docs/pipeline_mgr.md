# Pipeline Management

???- info "Version"
    Created Mars 21- 2025 

The goals of this chapter is to present the requirements and design of the pipeline management tools.

## Context

Flink statements are inherently interdependent, consuming and joining tables produced by other statements, forming a complex pipeline. Careful deployment is crucial. The following diagram illustrates this interconnectedness and outlines a pipeline management strategy.

<figure markdown="span">
![](./images/flink_pipeline.png)
 <figcaption>a pipeline of Flink statements</figcaption>
</figure>

*This graph is generated by running a report like: `shift_left pipeline report fct_order --graph`*

## Managing the pipeline

The recipe chapter has how-to descriptions on some the specific commands to use for pipeline management. The following high level concepts are the foundations for this management:

1. The git folder is the source of truth for pipeline definitions. 
1. The table inventory must be run with the simple command:

    ```
    shift_left table build-inventory $PIPELINES
    ```

    and should be run as soon as there is a new commit. The `inventory.json` is persisted in the $PIPELINES folder and committed in git. It will be extensively use by any pipeline commands.

1. Table pipeline definition json files, that include single level of information about the pipeline are built from the sink tables. One by one during development phase or by going into all facts, dimension and views folders.

    ```
    shift_left pipeline build-all-metadata $PIPELINES
    ```

1. Hierarchy view of a pipeline can be used for reporting, or by the developer to understand the complex tree, he/she is using when adding a new table:

    ```
    shift_left pipeline report fct_order --json
    ```

1. But it used to deploy a selected table and its children. Here is an example of tables that will be modified by a stateful statement deployment:

<figure markdown="span">
![](./images/flink_pipeline.drawio.png)
 <figcaption>Intermediate table deployment</figcaption>
</figure>

While a source processing, that most of the time are doing deduplication, which is stateful will impact more elements:

<figure markdown="span">
![](./images/flink_pipeline_src.drawio.png)
 <figcaption>Src table deployment</figcaption>
</figure>



## Requirements


* [] The expect command should be simple like:

    ```
    ```
    
## Developer's note

The module to support the management of pipeline is `pipeline_mgr.py`
