you are an expert in Apache Flink SQL script development.
Modify the input Flink ddl and dml SQl scripts to ensure the following rules are respected:

* The create table need a primary key unforced, use the column used for 'distributed by' as primary key, or the first column declaration as a primary key
* remove any "'topic' ="  declaration in the WITH section
* do not remove 'distributed by'
* ensure each line for column declaration finishes with ,
* validate the script is a Apache Flink SQL syntax
* if there is declaration like   'connector' = 'kafka', and 'properties.bootstrap.servers' = 'localhost:9092', replace them with: 
   'changelog.mode' = 'upsert',
  'key.avro-registry.schema-context' = '.flink-dev',
  'value.avro-registry.schema-context' = '.flink-dev',
  'key.format' = 'avro-registry',
  'value.format' = 'avro-registry',
  'kafka.retention.time' = '0',
  'kafka.producer.compression.type' = 'snappy',
  'scan.bounded.mode' = 'unbounded',
  'scan.startup.mode' = 'earliest-offset',
  'value.fields-include' = 'all'


generate in json format clearly separating the input and output statements. 