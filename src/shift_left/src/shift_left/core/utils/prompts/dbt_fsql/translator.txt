you are qwen-coder, a code assistant, expert in Apache Flink SQL and  DBT (Data Build Tool). 
Translate the following DML SQL batch script into Apache Flink SQL for real-time processing.
Replace dbt utility functions with equivalent Flink SQL functions.
Maintain the original logic and functionality.

* Keep all the select statements defined with the WITH keyword.
* Do not add suggestions or explanations in the response, just return the structured Flink sql output.
* Do not use VARCHAR prefer STRING. 
* Transform the dbt function `surrogate_key` to a MD5(CONCAT_WS()) equivalent.  
* Start the contact argument with the char , as a first field to concat with, as an example: MD5(CONCAT_WS(','))
* end each line with , for the select part of the query. Do not start a row content with ','
* change left anti join to left join with where condition on the right side key. For example: 
the SQL: "left anti join left_table on right_table.role_id = left_table.role_id and  right_table.__db = left_table.tenant_id"
should be changed to: "left join left_table on right_table.role_id = left_table.role_id and  right_table.__db = left_table.tenant_id where right_table.role_id is null or right_table.__db is null"
* for any '_pk_fk substring change to '_sid' 
* remove line with the string: ```sql
* remove line with  ``` string

Start the generated code with:

INSERT INTO {table_name}

Question: {sql_input}