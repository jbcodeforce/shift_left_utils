<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://jeromeboyer.net/shift_left_utils/compute_pool_optimizer/ rel=canonical><link rel=icon href=../assets/batchy.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>Compute Pool Usage Analyzer - Shift Left Utilities v0.1.44</title><link rel=stylesheet href=../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><link rel=stylesheet href=../extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#compute-pool-usage-analyzer class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Shift Left Utilities v0.1.44" class="md-header__button md-logo" aria-label="Shift Left Utilities v0.1.44" data-md-component=logo> <img src=../assets/batchy.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Shift Left Utilities v0.1.44 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Compute Pool Usage Analyzer </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/shift_left_utils title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Shift Left Utilities v0.1.44" class="md-nav__button md-logo" aria-label="Shift Left Utilities v0.1.44" data-md-component=logo> <img src=../assets/batchy.png alt=logo> </a> Shift Left Utilities v0.1.44 </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/shift_left_utils title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../dev_process/ class=md-nav__link> <span class=md-ellipsis> Development Process </span> </a> </li> <li class=md-nav__item> <a href=../setup/ class=md-nav__link> <span class=md-ellipsis> Environment Setup </span> </a> </li> <li class=md-nav__item> <a href=../recipes/ class=md-nav__link> <span class=md-ellipsis> Recipes </span> </a> </li> <li class=md-nav__item> <a href=../command/ class=md-nav__link> <span class=md-ellipsis> CLI References </span> </a> </li> <li class=md-nav__item> <a href=../mcp/ class=md-nav__link> <span class=md-ellipsis> MCP server </span> </a> </li> <li class=md-nav__item> <a href=../coding/test_harness/ class=md-nav__link> <span class=md-ellipsis> Test Harness </span> </a> </li> <li class=md-nav__item> <a href=../pipeline_mgr/ class=md-nav__link> <span class=md-ellipsis> Pipeline Management </span> </a> </li> <li class=md-nav__item> <a href=../blue_green_deploy/ class=md-nav__link> <span class=md-ellipsis> Blue/Green Deployment </span> </a> </li> <li class=md-nav__item> <a href=../perf_test/ class=md-nav__link> <span class=md-ellipsis> Performance Testing </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/flink-studies/coding/flink-sql/ class=md-nav__link> <span class=md-ellipsis> Flink SQL best practices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> For Contributors </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> For Contributors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../coding/ class=md-nav__link> <span class=md-ellipsis> Code structure </span> </a> </li> <li class=md-nav__item> <a href=../coding/llm_based_translation/ class=md-nav__link> <span class=md-ellipsis> AI based migration </span> </a> </li> <li class=md-nav__item> <a href=../tracking/ class=md-nav__link> <span class=md-ellipsis> Feature Tracking </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#features class=md-nav__link> <span class=md-ellipsis> Features </span> </a> <nav class=md-nav aria-label=Features> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comprehensive-analysis class=md-nav__link> <span class=md-ellipsis> 🔍 Comprehensive Analysis </span> </a> </li> <li class=md-nav__item> <a href=#smart-consolidation-heuristics class=md-nav__link> <span class=md-ellipsis> 🎯 Smart Consolidation Heuristics </span> </a> </li> <li class=md-nav__item> <a href=#detailed-reporting class=md-nav__link> <span class=md-ellipsis> 📊 Detailed Reporting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#usage class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> <nav class=md-nav aria-label=Usage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#command-line-interface class=md-nav__link> <span class=md-ellipsis> Command Line Interface </span> </a> </li> <li class=md-nav__item> <a href=#programmatic-usage class=md-nav__link> <span class=md-ellipsis> Programmatic Usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#analysis-output class=md-nav__link> <span class=md-ellipsis> Analysis Output </span> </a> <nav class=md-nav aria-label="Analysis Output"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#console-summary class=md-nav__link> <span class=md-ellipsis> Console Summary </span> </a> </li> <li class=md-nav__item> <a href=#detailed-json-report class=md-nav__link> <span class=md-ellipsis> Detailed JSON Report </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#analysis-scoping-strategy class=md-nav__link> <span class=md-ellipsis> Analysis Scoping Strategy </span> </a> <nav class=md-nav aria-label="Analysis Scoping Strategy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#recommended-analysis-approach class=md-nav__link> <span class=md-ellipsis> 🎯 Recommended Analysis Approach </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consolidation-heuristics class=md-nav__link> <span class=md-ellipsis> Consolidation Heuristics </span> </a> <nav class=md-nav aria-label="Consolidation Heuristics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-product-based-grouping class=md-nav__link> <span class=md-ellipsis> 1. Product-based Grouping </span> </a> </li> <li class=md-nav__item> <a href=#2-resource-based-grouping class=md-nav__link> <span class=md-ellipsis> 2. Resource-based Grouping </span> </a> </li> <li class=md-nav__item> <a href=#3-efficiency-based-grouping class=md-nav__link> <span class=md-ellipsis> 3. Efficiency-based Grouping </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recommendations class=md-nav__link> <span class=md-ellipsis> Recommendations </span> </a> </li> <li class=md-nav__item> <a href=#integration-points class=md-nav__link> <span class=md-ellipsis> Integration Points </span> </a> <nav class=md-nav aria-label="Integration Points"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#existing-architecture-integration class=md-nav__link> <span class=md-ellipsis> Existing Architecture Integration </span> </a> </li> <li class=md-nav__item> <a href=#cli-integration class=md-nav__link> <span class=md-ellipsis> CLI Integration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benefits class=md-nav__link> <span class=md-ellipsis> Benefits </span> </a> <nav class=md-nav aria-label=Benefits> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cost-optimization class=md-nav__link> <span class=md-ellipsis> Cost Optimization </span> </a> </li> <li class=md-nav__item> <a href=#operational-benefits class=md-nav__link> <span class=md-ellipsis> Operational Benefits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example-workflows class=md-nav__link> <span class=md-ellipsis> Example Workflows </span> </a> <nav class=md-nav aria-label="Example Workflows"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#product-team-workflow class=md-nav__link> <span class=md-ellipsis> Product Team Workflow </span> </a> </li> <li class=md-nav__item> <a href=#platform-team-workflow class=md-nav__link> <span class=md-ellipsis> Platform Team Workflow </span> </a> </li> <li class=md-nav__item> <a href=#cost-optimization-workflow class=md-nav__link> <span class=md-ellipsis> Cost Optimization Workflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#future-enhancements class=md-nav__link> <span class=md-ellipsis> Future Enhancements </span> </a> </li> <li class=md-nav__item> <a href=#technical-details class=md-nav__link> <span class=md-ellipsis> Technical Details </span> </a> <nav class=md-nav aria-label="Technical Details"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#models class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=#filtering-logic class=md-nav__link> <span class=md-ellipsis> Filtering Logic </span> </a> </li> <li class=md-nav__item> <a href=#dependencies class=md-nav__link> <span class=md-ellipsis> Dependencies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-start-examples class=md-nav__link> <span class=md-ellipsis> Quick Start Examples </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=compute-pool-usage-analyzer>Compute Pool Usage Analyzer<a class=headerlink href=#compute-pool-usage-analyzer title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>The Compute Pool Usage Analyzer is a new feature designed to analyze current compute pool usage across your Flink environment and assess opportunities for statement consolidation. This tool can help optimize resource allocation and reduce costs by identifying underutilized pools and providing consolidation recommendations.</p> <h2 id=features>Features<a class=headerlink href=#features title="Permanent link">&para;</a></h2> <h3 id=comprehensive-analysis>🔍 Comprehensive Analysis<a class=headerlink href=#comprehensive-analysis title="Permanent link">&para;</a></h3> <ul> <li><strong>Pool Usage Assessment</strong>: Analyzes CFU usage across all compute pools</li> <li><strong>Statement Discovery</strong>: Identifies all running statements and their pool assignments</li> <li><strong>Efficiency Metrics</strong>: Calculates statements-per-CFU ratios and efficiency scores</li> <li><strong>Scoped Analysis</strong>: Filter analysis by product or directory for targeted optimization</li> </ul> <h3 id=smart-consolidation-heuristics>🎯 Smart Consolidation Heuristics<a class=headerlink href=#smart-consolidation-heuristics title="Permanent link">&para;</a></h3> <ul> <li><strong>Product-based Grouping</strong>: Groups statements from the same data product</li> <li><strong>Resource-based Grouping</strong>: Identifies underutilized pools for consolidation</li> <li><strong>Efficiency-based Grouping</strong>: Finds pools with single statements that could be combined</li> </ul> <h3 id=detailed-reporting>📊 Detailed Reporting<a class=headerlink href=#detailed-reporting title="Permanent link">&para;</a></h3> <ul> <li><strong>Usage Statistics</strong>: Per-pool CFU usage and statement counts</li> <li><strong>Consolidation Recommendations</strong>: Specific suggestions for optimization</li> <li><strong>Cost Savings Estimates</strong>: Potential CFU savings from consolidation</li> </ul> <h2 id=usage>Usage<a class=headerlink href=#usage title="Permanent link">&para;</a></h2> <h3 id=command-line-interface>Command Line Interface<a class=headerlink href=#command-line-interface title="Permanent link">&para;</a></h3> <p>The analyzer supports flexible filtering options to focus analysis on specific areas:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Analyze all pools (global view)</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>/path/to/pipelines
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># Analyze for specific product (recommended for focused optimization)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Analyze for specific directory </span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--directory<span class=w> </span>/path/to/facts/saleops
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=c1># Combine product and directory filters for precision targeting</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops<span class=w> </span>--directory<span class=w> </span>/path/to/facts
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=c1># Short form options</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>-p<span class=w> </span>saleops<span class=w> </span>-d<span class=w> </span>/path/to/facts
</span></code></pre></div> <h3 id=programmatic-usage>Programmatic Usage<a class=headerlink href=#programmatic-usage title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>shift_left.core.compute_pool_usage_analyzer</span><span class=w> </span><span class=kn>import</span> <span class=n>ComputePoolUsageAnalyzer</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=c1># Create analyzer instance</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=n>analyzer</span> <span class=o>=</span> <span class=n>ComputePoolUsageAnalyzer</span><span class=p>()</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=c1># Global analysis</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=n>report</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>analyze_pool_usage</span><span class=p>(</span><span class=n>inventory_path</span><span class=o>=</span><span class=s2>&quot;/path/to/pipelines&quot;</span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=c1># Product-specific analysis</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=n>report</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>analyze_pool_usage</span><span class=p>(</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=n>inventory_path</span><span class=o>=</span><span class=s2>&quot;/path/to/pipelines&quot;</span><span class=p>,</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=n>product_name</span><span class=o>=</span><span class=s2>&quot;saleops&quot;</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=p>)</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=c1># Directory-specific analysis  </span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=n>report</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>analyze_pool_usage</span><span class=p>(</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=n>inventory_path</span><span class=o>=</span><span class=s2>&quot;/path/to/pipelines&quot;</span><span class=p>,</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=n>directory</span><span class=o>=</span><span class=s2>&quot;/path/to/facts/saleops&quot;</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=p>)</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=c1># Combined filtering</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=n>report</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>analyze_pool_usage</span><span class=p>(</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>    <span class=n>inventory_path</span><span class=o>=</span><span class=s2>&quot;/path/to/pipelines&quot;</span><span class=p>,</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>    <span class=n>product_name</span><span class=o>=</span><span class=s2>&quot;saleops&quot;</span><span class=p>,</span> 
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>    <span class=n>directory</span><span class=o>=</span><span class=s2>&quot;/path/to/facts&quot;</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=p>)</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=c1># Print summary</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=n>summary</span> <span class=o>=</span> <span class=n>analyzer</span><span class=o>.</span><span class=n>print_analysis_summary</span><span class=p>(</span><span class=n>report</span><span class=p>)</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=nb>print</span><span class=p>(</span><span class=n>summary</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=c1># Access detailed data</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=k>for</span> <span class=n>pool</span> <span class=ow>in</span> <span class=n>report</span><span class=o>.</span><span class=n>pool_stats</span><span class=p>:</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pool </span><span class=si>{</span><span class=n>pool</span><span class=o>.</span><span class=n>pool_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>pool</span><span class=o>.</span><span class=n>usage_percentage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% used, </span><span class=si>{</span><span class=n>pool</span><span class=o>.</span><span class=n>statement_count</span><span class=si>}</span><span class=s2> statements&quot;</span><span class=p>)</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=k>for</span> <span class=n>rec</span> <span class=ow>in</span> <span class=n>report</span><span class=o>.</span><span class=n>recommendations</span><span class=p>:</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Recommendation: </span><span class=si>{</span><span class=n>rec</span><span class=o>.</span><span class=n>reason</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Potential savings: </span><span class=si>{</span><span class=n>rec</span><span class=o>.</span><span class=n>estimated_cfu_savings</span><span class=si>}</span><span class=s2> CFUs&quot;</span><span class=p>)</span>
</span></code></pre></div> <h2 id=analysis-output>Analysis Output<a class=headerlink href=#analysis-output title="Permanent link">&para;</a></h2> <h3 id=console-summary>Console Summary<a class=headerlink href=#console-summary title="Permanent link">&para;</a></h3> <p>The analyzer provides a comprehensive console summary including:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>============================================================
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>COMPUTE POOL USAGE ANALYSIS SUMMARY  
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>============================================================
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>Analysis Date: 2024-12-19 10:30:15
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>Environment: env-abc123
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>Analysis Scope: Product: saleops, Directory: /path/to/facts
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>OVERALL STATISTICS:
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>  Total Pools: 3 (filtered from 8 total pools)
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>  Total Statements: 7 (filtered from 25 total statements)
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>  Total CFU Used: 15
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>  Total CFU Capacity: 30
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>  Overall Utilization: 50.0%
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>  Overall Efficiency: 0.47 statements/CFU
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>POOL USAGE DETAILS:
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>  saleops-facts-pool (pool-123):
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>    Usage: 8/15 CFU (53.3%)
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>    Statements: 4
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>    Efficiency: 0.50 statements/CFU
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>  saleops-staging-pool (pool-456):
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>    Usage: 7/15 CFU (46.7%)
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>    Statements: 3
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>    Efficiency: 0.43 statements/CFU
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>CONSOLIDATION RECOMMENDATIONS:
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>  consolidate_product_saleops:
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>    Complexity: LOW
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>    Estimated CFU Savings: 5
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>    Statements to Move: 3
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>    Reason: Product saleops statements scattered across 2 pools can be consolidated
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>============================================================
</span></code></pre></div> <h3 id=detailed-json-report>Detailed JSON Report<a class=headerlink href=#detailed-json-report title="Permanent link">&para;</a></h3> <p>A detailed JSON report is saved with complete analysis data including scope information:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=p>{</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class=nt>&quot;created_at&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2024-12-19T10:30:15&quot;</span><span class=p>,</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=nt>&quot;environment_id&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;env-abc123&quot;</span><span class=p>,</span><span class=w> </span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class=nt>&quot;analysis_scope&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=nt>&quot;product_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;saleops&quot;</span><span class=p>,</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=nt>&quot;directory&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/path/to/facts&quot;</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>  </span><span class=p>},</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>  </span><span class=nt>&quot;total_pools&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>  </span><span class=nt>&quot;total_statements&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>7</span><span class=p>,</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>  </span><span class=nt>&quot;pool_stats&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=err>...</span><span class=p>],</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>  </span><span class=nt>&quot;statement_groups&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=err>...</span><span class=p>],</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>  </span><span class=nt>&quot;recommendations&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=err>...</span><span class=p>]</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=p>}</span>
</span></code></pre></div> <h2 id=analysis-scoping-strategy>Analysis Scoping Strategy<a class=headerlink href=#analysis-scoping-strategy title="Permanent link">&para;</a></h2> <h3 id=recommended-analysis-approach>🎯 Recommended Analysis Approach<a class=headerlink href=#recommended-analysis-approach title="Permanent link">&para;</a></h3> <p><strong>1. Product-Level Analysis (Most Common)</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops
</span></code></pre></div> - <strong>Best for</strong>: Day-to-day optimization decisions - <strong>Benefits</strong>: Clear ownership boundaries, manageable scope - <strong>Use case</strong>: "How can we optimize the saleops product pools?"</p> <p><strong>2. Directory-Level Analysis</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--directory<span class=w> </span>/path/to/facts
</span></code></pre></div> - <strong>Best for</strong>: Layer-specific optimization (facts, dimensions, sources) - <strong>Benefits</strong>: Focuses on similar workload patterns - <strong>Use case</strong>: "Are our fact tables efficiently distributed across pools?"</p> <p><strong>3. Combined Product + Directory</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops<span class=w> </span>--directory<span class=w> </span>/path/to/facts
</span></code></pre></div> - <strong>Best for</strong>: Precision targeting of specific areas - <strong>Benefits</strong>: Maximum focus, actionable recommendations - <strong>Use case</strong>: "Optimize just the saleops fact tables"</p> <p><strong>4. Global Analysis</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage
</span></code></pre></div> - <strong>Best for</strong>: Strategic overview, capacity planning - <strong>Benefits</strong>: Complete picture, cross-product insights - <strong>Use case</strong>: "What's our overall pool efficiency across all products?"</p> <h2 id=consolidation-heuristics>Consolidation Heuristics<a class=headerlink href=#consolidation-heuristics title="Permanent link">&para;</a></h2> <h3 id=1-product-based-grouping>1. Product-based Grouping<a class=headerlink href=#1-product-based-grouping title="Permanent link">&para;</a></h3> <ul> <li>Groups statements belonging to the same data product</li> <li><strong>Enhanced with scoping</strong>: When analyzing by product, focuses on cross-pool consolidation within that product</li> <li>Recommends consolidation to improve resource utilization</li> </ul> <h3 id=2-resource-based-grouping>2. Resource-based Grouping<a class=headerlink href=#2-resource-based-grouping title="Permanent link">&para;</a></h3> <ul> <li>Identifies pools with low statement density (&lt; 0.5 statements per CFU)</li> <li><strong>Enhanced with scoping</strong>: Only considers pools within the filtered scope</li> <li>Focuses on improving overall resource efficiency</li> </ul> <h3 id=3-efficiency-based-grouping>3. Efficiency-based Grouping<a class=headerlink href=#3-efficiency-based-grouping title="Permanent link">&para;</a></h3> <ul> <li>Finds pools running only single statements</li> <li><strong>Enhanced with scoping</strong>: Prioritizes single-statement pools within the analysis scope</li> <li>Calculates consolidation potential for better CFU utilization</li> </ul> <h2 id=recommendations>Recommendations<a class=headerlink href=#recommendations title="Permanent link">&para;</a></h2> <p>The analyzer generates specific recommendations with:</p> <ul> <li><strong>Migration Complexity</strong>: LOW/MEDIUM/HIGH based on number of statements</li> <li><strong>CFU Savings Estimates</strong>: Potential resource reduction within scope</li> <li><strong>Target Pool Suggestions</strong>: Best pools for consolidation</li> <li><strong>New Pool Recommendations</strong>: When creating new pools is more efficient</li> </ul> <h2 id=integration-points>Integration Points<a class=headerlink href=#integration-points title="Permanent link">&para;</a></h2> <h3 id=existing-architecture-integration>Existing Architecture Integration<a class=headerlink href=#existing-architecture-integration title="Permanent link">&para;</a></h3> <ul> <li>Uses existing <code>compute_pool_mgr</code> for pool data</li> <li>Leverages <code>statement_mgr</code> for statement information </li> <li>Integrates with pipeline inventory system for product/directory filtering</li> <li>Follows established error handling patterns</li> </ul> <h3 id=cli-integration>CLI Integration<a class=headerlink href=#cli-integration title="Permanent link">&para;</a></h3> <ul> <li>Added to <code>pipeline</code> command group with intuitive options</li> <li>Follows existing CLI patterns and styling</li> <li>Provides both summary and detailed output options</li> </ul> <h2 id=benefits>Benefits<a class=headerlink href=#benefits title="Permanent link">&para;</a></h2> <h3 id=cost-optimization>Cost Optimization<a class=headerlink href=#cost-optimization title="Permanent link">&para;</a></h3> <ul> <li><strong>Focused Savings</strong>: Target specific products or directories for immediate impact</li> <li><strong>Reduced CFU Usage</strong>: Consolidate underutilized pools within scope</li> <li><strong>Improved Efficiency</strong>: Better statements-per-CFU ratios where it matters most</li> <li><strong>Strategic Planning</strong>: Different scopes for different optimization goals</li> </ul> <h3 id=operational-benefits>Operational Benefits<a class=headerlink href=#operational-benefits title="Permanent link">&para;</a></h3> <ul> <li><strong>Incremental Approach</strong>: Start with one product, expand to others</li> <li><strong>Team Alignment</strong>: Product-based analysis aligns with team boundaries</li> <li><strong>Reduced Risk</strong>: Smaller scope reduces migration complexity</li> <li><strong>Better Utilization</strong>: More efficient resource usage in target areas</li> </ul> <h2 id=example-workflows>Example Workflows<a class=headerlink href=#example-workflows title="Permanent link">&para;</a></h2> <h3 id=product-team-workflow>Product Team Workflow<a class=headerlink href=#product-team-workflow title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Weekly optimization check for saleops team</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># Focus on facts if issues found</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>saleops<span class=w> </span>--directory<span class=w> </span>/path/to/facts
</span></code></pre></div> <h3 id=platform-team-workflow>Platform Team Workflow<a class=headerlink href=#platform-team-workflow title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Monthly strategic review</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=c1># Deep dive into underutilized areas</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--directory<span class=w> </span>/path/to/sources
</span></code></pre></div> <h3 id=cost-optimization-workflow>Cost Optimization Workflow<a class=headerlink href=#cost-optimization-workflow title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Identify biggest opportunities by product</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=k>for</span><span class=w> </span>product<span class=w> </span><span class=k>in</span><span class=w> </span>saleops<span class=w> </span>marketing<span class=w> </span>analytics<span class=p>;</span><span class=w> </span><span class=k>do</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span><span class=nv>$product</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=k>done</span>
</span></code></pre></div> <h2 id=future-enhancements>Future Enhancements<a class=headerlink href=#future-enhancements title="Permanent link">&para;</a></h2> <p>While the current implementation uses simple heuristics with powerful scoping, it provides a foundation for more sophisticated optimization approaches:</p> <ol> <li><strong>O/R Problem Integration</strong>: Full operations research optimization within scoped boundaries</li> <li><strong>Machine Learning</strong>: Pattern recognition for usage optimization per product/directory</li> <li><strong>Cost Modeling</strong>: Detailed cost analysis and projections with scope awareness </li> <li><strong>Automated Migration</strong>: Seamless statement movement within filtered scope</li> <li><strong>Capacity Planning</strong>: Predictive resource requirement modeling per product</li> <li><strong>Cross-Product Analysis</strong>: Identify shared resources and consolidation opportunities across products</li> </ol> <h2 id=technical-details>Technical Details<a class=headerlink href=#technical-details title="Permanent link">&para;</a></h2> <h3 id=models>Models<a class=headerlink href=#models title="Permanent link">&para;</a></h3> <ul> <li><code>PoolUsageStats</code>: Per-pool usage statistics (filtered by scope)</li> <li><code>StatementGroup</code>: Groups of statements for consolidation (within scope)</li> <li><code>ConsolidationRecommendation</code>: Specific optimization suggestions (scope-aware)</li> <li><code>PoolAnalysisReport</code>: Complete analysis results with scope metadata</li> </ul> <h3 id=filtering-logic>Filtering Logic<a class=headerlink href=#filtering-logic title="Permanent link">&para;</a></h3> <ul> <li><strong>Product Filtering</strong>: Uses pipeline inventory to map statements to products</li> <li><strong>Directory Filtering</strong>: Uses inventory table folder paths for directory matching</li> <li><strong>Combined Filtering</strong>: Applies both filters for precision targeting</li> <li><strong>Fallback Behavior</strong>: Without inventory, performs global analysis</li> </ul> <h3 id=dependencies>Dependencies<a class=headerlink href=#dependencies title="Permanent link">&para;</a></h3> <ul> <li>Pydantic models for data validation</li> <li>Existing compute pool and statement management systems</li> <li>Pipeline inventory integration for product/directory context</li> <li>FlinkTableReference model for metadata extraction</li> </ul> <p>This enhanced feature provides immediate value for targeted resource optimization while establishing the foundation for more advanced, scope-aware optimization capabilities in the future.</p> <h2 id=quick-start-examples>Quick Start Examples<a class=headerlink href=#quick-start-examples title="Permanent link">&para;</a></h2> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Start with your main product</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>your-product
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># If recommendations found, drill down to specific layers</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--product-name<span class=w> </span>your-product<span class=w> </span>--directory<span class=w> </span>facts
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=c1># For platform teams - strategic overview</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=c1># Focus on efficiency issues</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>shift-left<span class=w> </span>pipeline<span class=w> </span>analyze-pool-usage<span class=w> </span>--directory<span class=w> </span>sources<span class=w>  </span><span class=c1># Often has single-statement pools</span>
</span></code></pre></div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Jerome Boyer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jbcodeforce target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/jeromeboyer target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "search.suggest", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs.sticky", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>